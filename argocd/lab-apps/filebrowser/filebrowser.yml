apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: filebrowser
  namespace: argocd
spec:
  destination:
    name: ''
    namespace: filebrowser
    server: 'https://kubernetes.default.svc'
  source:
    path: ''
    repoURL: 'https://k8s-at-home.com/charts/'
    targetRevision: 1.3.2
    chart: filebrowser
    helm:
      values: |-
        env:
          TZ: PT

        service:
          main:
            ports:
              http:
                port: 80

        ingress:
          main:
            enabled: false

        config: |
          {
            "port": 80,
            "baseURL": "",
            "address": "",
            "log": "stdout",
            "database": "/config/database.db",
            "root": "/srv/data"
          }

        persistence:
          config:
            enabled: true
            type: pvc
            subPath:
              - path: config
                mountPath: /config
              - path: data
                mountPath: /srv

  project: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - ApplyOutOfSyncOnly=true
      - PruneLast=true
